# Disable directory listing and guesswork
Options -MultiViews -Indexes

RewriteEngine On
RewriteBase /

# 1. FORCE REMOVE TRAILING SLASHES
# If it's not a real directory, strip the slash (fixes /about/ -> /about)
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} (.+)/$
RewriteRule ^ %1 [L,R=301]

# 2. HANDLE DOUBLE SLASHES (Optional but good for consistency)
# Fixes /about// -> /about
RewriteCond %{REQUEST_URI} ^(.*)//+(.*)$
RewriteRule . %1/%2 [R=301,L]

# 3. MAP PATHS TO .HTML FILES
# If /about is requested, check if about.html exists and serve it
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{DOCUMENT_ROOT}/$1.html -f
RewriteRule ^(.*)$ $1.html [L]

# 4. ASSET RECOVERY (The folder check)
# If the request is for an image inside the /about/ folder, allow it
RewriteCond %{REQUEST_URI} ^/about/.*$
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

# 5. SPA FALLBACK
# Only if all the above fail, show the homepage
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.html [L]